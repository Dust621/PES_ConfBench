{
  "topology": "四台路由器 R1、R2、R3 在 AS1500，R4 在 AS1600。R1 与 R2 链接 10.100.1.0/30，R2 与 R3 链接 10.100.2.0/30，R3 与 R4 链接 203.0.114.0/30。R1 附属 172.20.1.0/24，R4 附属 172.20.4.0/24。",
  "requirement": "AS1500 内使用 OSPF area 0；在 R3 与 R4 之间建立 eBGP 邻居，要求 R1 网络在 AS1600 可见，R4 网络在 AS1500 可见，并且在 BGP 通告中施加前缀过滤，仅允许 172.20.4.0/24 从 AS1600 通告进来。",
  "verification": "在 R3 上 show ip bgp received-routes 应只看到 172.20.4.0/24；在 R1 ping 172.20.4.1／R4 ping 172.20.1.1 成功。",
  "verification_tasks": [
    {
      "type": "ospf_area_contains",
      "area": "0",
      "nodes": [
        "R1",
        "R2",
        "R3"
      ],
      "description": "AS1500 内 R1、R2、R3 在 area 0"
    },
    {
      "type": "bgp_session_between",
      "a_node": "R3",
      "b_node": "R4",
      "expect": "ESTABLISHED",
      "description": "R3↔R4 eBGP 建立"
    },
    {
      "type": "bgp_received_only",
      "node": "R3",
      "from_neighbor": "R4",
      "allowed_prefixes": [
        "172.20.4.0/24"
      ],
      "deny_others": true,
      "description": "仅允许 172.20.4.0/24 从 AS1600 进入 AS1500"
    },
    {
      "type": "route_exists",
      "node": "R1",
      "prefix": "172.20.4.0/24",
      "description": "AS1500 内部可见 172.20.4.0/24"
    },
    {
      "type": "reachability",
      "src_node": "R1",
      "dst_ip": "172.20.4.1",
      "description": "R1 可达 R4 主机"
    },
    {
      "type": "reachability",
      "src_node": "R4",
      "dst_ip": "172.20.1.1",
      "description": "R4 可达 R1 主机"
    }
  ]
}