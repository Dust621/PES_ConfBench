{
  "topology": "该网络拓扑由6台路由器组成，分布在4个自治系统中：\n\n**物理拓扑结构：**\n- DeviceA（AS100）通过interface1连接DeviceB的interface1\n- DeviceB（AS200核心）作为中心节点，通过interface2连接DeviceC的interface2，通过interface3连接DeviceD的interface2\n- DeviceC（AS200边缘）通过interface1连接DeviceE的interface1，通过interface3连接DeviceD的interface3\n- DeviceD（AS200边缘）通过interface1连接DeviceF的interface1\n- DeviceE（AS300）和DeviceF（AS400）分别作为AS200的出口设备\n\n**IP地址分配：**\n- DeviceA-DeviceB链路：10.20.1.0/24网段\n- DeviceB-DeviceC链路：10.0.1.0/24网段  \n- DeviceB-DeviceD链路：10.0.3.0/24网段\n- DeviceC-DeviceD链路：10.0.2.0/24网段\n- DeviceC-DeviceE链路：10.20.2.0/24网段\n- DeviceD-DeviceF链路：10.20.3.0/24网段\n- 各设备Loopback接口分别为1.1.1.1/32到6.6.6.6/32\n\n**BGP连接关系：**\n- EBGP连接：DeviceA（AS100）-DeviceB（AS200）、DeviceC（AS200）-DeviceE（AS300）、DeviceD（AS200）-DeviceF（AS400）\n- IBGP连接：AS200内部DeviceB与DeviceC、DeviceD之间通过Loopback接口建立连接\n\n**内部路由协议：**\nAS200内部运行OSPF协议，所有接口均在Area 0中，确保IBGP邻居间的连通性。\n\n**流量控制机制：**\n- DeviceE向DeviceC发布缺省路由，DeviceC接受所有来自AS300的缺省路由\n- DeviceF向DeviceD发布缺省路由，DeviceD通过路由策略将来自AS400的缺省路由本地优先级设置为80，实现AS200出向流量在DeviceE和DeviceF之间的负载均衡",
  "requirement": "通过控制缺省路由的发布，控制流量从不同的路径离开AS。配置完成后，AS200的出流量可以通过DeviceE和DeviceF来进行分担。",
  "steps": [
    "在DeviceB、DeviceC和DeviceD上配置OSPF协议。",
    "在DeviceA和DeviceB之间、DeviceC和DeviceE之间、DeviceD和DeviceF之间分别配置EBGP连接。",
    "在DeviceB和DeviceC之间、DeviceB和DeviceD之间分别配置IBGP连接。",
    "在DeviceC上配置入口策略，只允许接收缺省路由。",
    "在DeviceD上配置入口策略，允许接收缺省路由和所有明细路由，并对接收的缺省路由设置Local_Pref值。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.20.1.1 255.255.255.0\n#\ninterface LoopBack1\n ip address 1.1.1.1 255.255.255.255\n#\nbgp 100\n router-id 1.1.1.1\n peer 10.20.1.2 as-number 200\n ipv4-family unicast\n  peer 10.20.1.2 enable\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.20.1.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/1\n undo shutdown\n ip address 10.0.1.1 255.255.255.0\n#\ninterface GigabitEthernet3/0/1\n undo shutdown\n ip address 10.0.3.2 255.255.255.0\n#\ninterface LoopBack1\n ip address 2.2.2.2 255.255.255.255\n#\nbgp 200\n router-id 2.2.2.2\n peer 3.3.3.3 as-number 200\n peer 3.3.3.3 connect-interface LoopBack1\n peer 4.4.4.4 as-number 200\n peer 4.4.4.4 connect-interface LoopBack1\n peer 10.20.1.1 as-number 100\n ipv4-family unicast\n  network 10.20.1.0 255.255.255.0\n  peer 3.3.3.3 enable\n  peer 4.4.4.4 enable\n  peer 10.20.1.1 enable\n#\nospf 1\n area 0.0.0.0\n  network 2.2.2.2 0.0.0.0\n  network 10.0.1.0 0.0.0.255\n  network 10.0.3.0 0.0.0.255\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.20.2.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/1\n undo shutdown\n ip address 10.0.1.2 255.255.255.0\n#\ninterface GigabitEthernet3/0/1\n undo shutdown\n ip address 10.0.2.1 255.255.255.0\n#\ninterface LoopBack1\n ip address 3.3.3.3 255.255.255.255\n#\nbgp 200\n router-id 3.3.3.3\n peer 2.2.2.2 as-number 200\n peer 2.2.2.2 connect-interface LoopBack1\n peer 10.20.2.1 as-number 300\n ipv4-family unicast\n  network 10.20.2.0 255.255.255.0\n  peer 2.2.2.2 enable\n  peer 10.20.2.1 enable\n  peer 10.20.2.1 ip-prefix default import\n#\nospf 1\n area 0.0.0.0\n  network 3.3.3.3 0.0.0.0\n  network 10.0.1.0 0.0.0.255\n  network 10.0.2.0 0.0.0.255\n#\nip ip-prefix default index 10 permit 0.0.0.0 0\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.20.3.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/1\n undo shutdown\n ip address 10.0.3.1 255.255.255.0\n#\ninterface GigabitEthernet3/0/1\n undo shutdown\n ip address 10.0.2.2 255.255.255.0\n#\ninterface LoopBack1\n ip address 4.4.4.4 255.255.255.255\n#\nbgp 200\n router-id 4.4.4.4\n peer 2.2.2.2 as-number 200\n peer 2.2.2.2 connect-interface LoopBack1\n peer 10.20.3.1 as-number 400\n ipv4-family unicast\n  network 10.20.3.0 255.255.255.0\n  peer 2.2.2.2 enable\n  peer 10.20.3.1 enable\n  peer 10.20.3.1 as-path-filter 10 import\n  peer 10.20.3.1 route-policy set-default-low import\n#\nospf 1\n area 0.0.0.0\n  network 4.4.4.4 0.0.0.0\n  network 10.0.2.0 0.0.0.255\n  network 10.0.3.0 0.0.0.255\n#\nip ip-prefix default index 10 permit 0.0.0.0 0\n#\nip as-path-filter 10 index 10 permit ^(400_)+$\n#\nip as-path-filter 10 index 20 permit ^(400_)+_[0-9]+$\n#\nroute-policy set-default-low permit node 10\n if-match ip-prefix default\n apply local-preference 80\n#\nroute-policy set-default-low permit node 20\n#\nreturn",
    "DeviceE": "#\nsysname DeviceE\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.20.2.1 255.255.255.0\n#\ninterface GigabitEthernet2/0/1\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n#\ninterface LoopBack1\n ip address 5.5.5.5 255.255.255.255\n#\nbgp 300\n router-id 5.5.5.5\n peer 10.20.2.2 as-number 200\n ipv4-family unicast\n  network 10.1.1.0 255.255.255.0\n  peer 10.20.2.2 enable\n  peer 10.20.2.2 default-route-advertise\n#\nreturn",
    "DeviceF": "#\nsysname DeviceF\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.20.3.1 255.255.255.0\n#\ninterface GigabitEthernet2/0/1\n undo shutdown\n ip address 10.2.1.1 255.255.255.0\n#\ninterface LoopBack1\n ip address 6.6.6.6 255.255.255.255\n#\nbgp 400\n router-id 6.6.6.6\n peer 10.20.3.2 as-number 200\n ipv4-family unicast\n  network 10.2.1.0 255.255.255.0\n  peer 10.20.3.2 enable\n  peer 10.20.3.2 default-route-advertise\n#\nreturn"
  },
  "related_images": [
    "图1-152配置BGP发布缺省路由组网图.png"
  ]
}