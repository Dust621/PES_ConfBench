{
  "topology": "在AS65010内，部署了基于路由反射器（Route Reflector）的BGP网络架构，包含7台设备，分为两个集群：\n\n**Cluster1（集群ID：1）**：\n- DeviceB作为路由反射器（Router-ID: 2.2.2.2），通过interface1连接DeviceA（10.1.1.0/24网段），通过interface4连接DeviceD（10.1.4.0/24网段），通过interface3连接DeviceE（10.1.5.0/24网段），通过interface2连接DeviceC（10.1.2.0/24网段）\n- DeviceD和DeviceE为其反射客户机，DeviceD还通过interface2连接DeviceE（10.1.6.0/24网段）\n\n**Cluster2（集群ID：2）**：\n- DeviceC作为路由反射器（Router-ID: 3.3.3.3），通过interface2连接DeviceA（10.1.3.0/24网段），通过interface1连接DeviceB（10.1.2.0/24网段），通过interface3连接DeviceF（10.1.7.0/24网段），通过interface4连接DeviceG（10.1.8.0/24网段），通过interface5连接DeviceH（10.1.9.0/24网段）\n- DeviceF、DeviceG和DeviceH为其反射客户机\n\n**核心连接**：\n- DeviceA（Router-ID: 1.1.1.1）作为非客户机设备，通过interface3对外发布172.16.1.0/24网段\n- DeviceB和DeviceC互为非客户机，通过10.1.2.0/24网段直连\n- DeviceA分别与两个路由反射器建立对等连接，避免了全网状连接的复杂性",
  "requirement": "在大型网络中，一个AS内存在多台运行BGP协议的路由器，这些路由器之间需要使用BGP相互传递路由。为了简化网络配置并减少路由器的开销，用户希望避免在所有路由器之间建立逻辑全连接（Full-mesh）关系。",
  "steps": [
    "配置客户机与路由反射器之间，非客户机与路由反射器之间建立IBGP连接。",
    "在DeviceB和DeviceC上配置路由反射器功能，指定客户机，并查看路由信息。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.3.2 255.255.255.0\n#\ninterface GigabitEthernet3/0/0\n undo shutdown\n ip address 172.16.1.1 255.255.255.0\n#\nbgp 65010\n router-id 1.1.1.1\n peer 10.1.1.1 as-number 65010\n peer 10.1.3.1 as-number 65010\n #\n ipv4-family unicast\n  undo synchronization\n  network 172.16.1.0 255.255.255.0\n  peer 10.1.1.1 enable\n  peer 10.1.3.1 enable\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.4.1 255.255.255.0\n#\ninterface GigabitEthernet3/0/0\n undo shutdown\n ip address 10.1.5.1 255.255.255.0\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.1.2.1 255.255.255.0\n#\nbgp 65010\n router-id 2.2.2.2\n peer 10.1.1.2 as-number 65010\n peer 10.1.2.2 as-number 65010\n group in_rr internal\n peer 10.1.4.2 as-number 65010\n peer 10.1.4.2 group in_rr\n peer 10.1.5.2 as-number 65010\n peer 10.1.5.2 group in_rr\n #\n ipv4-family unicast\n  undo synchronization\n  undo reflect between-clients\n  reflector cluster-id 1\n  peer 10.1.1.2 enable\n  peer 10.1.2.2 enable\n  peer in_rr enable\n  peer in_rr reflect-client\n  peer 10.1.4.2 enable\n  peer 10.1.4.2 group in_rr\n  peer 10.1.5.2 enable\n  peer 10.1.5.2 group in_rr\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.2.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.3.1 255.255.255.0\n#\ninterface GigabitEthernet3/0/0\n undo shutdown\n ip address 10.1.7.1 255.255.255.0\n#\ninterface GigabitEthernet1/0/1\n undo shutdown\n ip address 10.1.8.1 255.255.255.0\n#\ninterface GigabitEthernet1/0/2\n undo shutdown\n ip address 10.1.9.1 255.255.255.0\n#\nbgp 65010\n router-id 3.3.3.3\n peer 10.1.2.1 as-number 65010\n peer 10.1.3.2 as-number 65010\n group in_rr internal\n peer 10.1.7.2 as-number 65010\n peer 10.1.7.2 group in_rr\n peer 10.1.8.2 as-number 65010\n peer 10.1.8.2 group in_rr\n peer 10.1.9.2 as-number 65010\n peer 10.1.9.2 group in_rr\n #\n ipv4-family unicast\n  undo synchronization\n  reflector cluster-id 2\n  peer 10.1.2.1 enable\n  peer 10.1.3.2 enable\n  peer in_rr enable\n  peer in_rr reflect-client\n  peer 10.1.7.2 enable\n  peer 10.1.7.2 group in_rr\n  peer 10.1.8.2 enable\n  peer 10.1.8.2 group in_rr\n  peer 10.1.9.2 enable\n  peer 10.1.9.2 group in_rr\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.4.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.6.1 255.255.255.0\n#\nbgp 65010\n router-id 4.4.4.4\n peer 10.1.4.1 as-number 65010\n #\n ipv4-family unicast\n  undo synchronization\n  peer 10.1.4.1 enable\n#\nreturn"
  },
  "related_images": [
    "图1-147 配置BGP 路由反射器组网图.png"
  ]
}