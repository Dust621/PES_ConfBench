{
  "topology": "基于网络拓扑图和配置文件分析，增强的网络拓扑描述如下：\n\n**物理拓扑结构：**\n网络由5台路由器组成线性拓扑结构：DeviceA - DeviceB - DeviceC - DeviceD - DeviceE\n\n**设备连接关系：**\n- DeviceA(1.1.1.1/32) - DeviceB(2.2.2.2/32)：通过10.1.1.0/24网段连接，DeviceA接口10.1.1.1，DeviceB接口10.1.1.2\n- DeviceB(2.2.2.2/32) - DeviceC(3.3.3.3/32)：通过10.1.2.0/24网段连接，DeviceB接口10.1.2.2，DeviceC接口10.1.2.1  \n- DeviceC(3.3.3.3/32) - DeviceD(4.4.4.4/32)：通过10.1.3.0/24网段连接，DeviceC接口10.1.3.1，DeviceD接口10.1.3.2\n- DeviceD(4.4.4.4/32) - DeviceE(5.5.5.5/32)：通过10.1.4.0/24网段连接，DeviceD接口10.1.4.1，DeviceE接口10.1.4.2\n\n**IGP域划分：**\n- IGP域1：DeviceA、DeviceB、DeviceC运行OSPF 1，路由器ID分别为1.1.1.1、2.2.2.2、3.3.3.3，均属于Area 0.0.0.0\n- IGP域2：DeviceC、DeviceD运行IS-IS 1，NET分别为10.0000.0000.0000.0010.00、10.0000.0000.0000.0020.00\n- IGP域3：DeviceD、DeviceE运行OSPF 2，路由器ID分别为4.4.4.4、5.5.5.5，均属于Area 0.0.0.0\n\n**BGP配置：**\n- 所有设备属于AS 100\n- DeviceC和DeviceD作为路由反射器（RR），形成BGP骨干网\n- BGP邻居关系：DeviceA-DeviceC、DeviceC-DeviceD、DeviceD-DeviceE\n- 启用BGP SR功能，设备segment-routing global-block分别为：DeviceA(16000)、DeviceC(18000)、DeviceD(20000)、DeviceE(22000)\n\n**MPLS配置：**\n- 所有设备启用MPLS LSR功能和LDP协议\n- 所有物理接口启用MPLS和MPLS LDP\n- 配置LDP LSP提供底层标签转发\n- 配置BGP SR LSP实现1.1.1.1到5.5.5.5的端到端MPLS隧道，DeviceA和DeviceE的label-index均为10",
  "requirement": "通过在同一AS内的设备中部署一条完整的BGP SR LSP，实现端到端的业务互通。配置一条从1.1.1.1到5.5.5.5的内层MPLS隧道，即内层BGP SR LSP，使得从1.1.1.1到5.5.5.5的流量采用MPLS转发。",
  "steps": [
    "配置接口IP：为各设备的接口配置IP地址。",
    "配置IGP域：在DeviceA～DeviceC之间配置OSPF，DeviceC～DeviceD之间配置IS-IS，DeviceD～DeviceE之间配置OSPF。",
    "配置MPLS基本能力和MPLS LDP：在各设备上配置MPLS基本能力和MPLS LDP，建立LDP LSP。",
    "配置BGP SR LSP：配置BGP SR LSP，实现跨IGP域的MPLS转发。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nmpls lsr-id 1.1.1.1\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 1.1.1.1 255.255.255.255\n#\nbgp 100\n segment-routing global-block 16000\n peer 3.3.3.3 as-number 100\n peer 3.3.3.3 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n network 1.1.1.1 255.255.255.255 label-index 10\n peer 3.3.3.3 enable\n peer 3.3.3.3 route-policy policy1 export\n peer 3.3.3.3 label-route-capability\n peer 3.3.3.3 prefix-sid\n#\nospf 1\n router-id 1.1.1.1\n area 0.0.0.0\n network 1.1.1.1 0.0.0.0\n network 10.1.1.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n apply mpls-label\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nmpls lsr-id 2.2.2.2\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.2.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.1.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 2.2.2.2 255.255.255.255\n#\nospf 1\n router-id 2.2.2.2\n area 0.0.0.0\n network 2.2.2.2 0.0.0.0\n network 10.1.1.0 0.0.0.255\n network 10.1.2.0 0.0.0.255\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nmpls lsr-id 3.3.3.3\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\nisis 1\n network-entity 10.0000.0000.0000.0010.00\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.3.1 255.255.255.0\n isis enable\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.2.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 3.3.3.3 255.255.255.255\n isis enable\n#\nbgp 100\n segment-routing global-block 18000\n peer 1.1.1.1 as-number 100\n peer 1.1.1.1 connect-interface LoopBack1\n peer 4.4.4.4 as-number 100\n peer 4.4.4.4 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n peer 1.1.1.1 enable\n peer 1.1.1.1 route-policy policy1 export\n peer 1.1.1.1 reflect-client\n peer 1.1.1.1 next-hop-local\n peer 1.1.1.1 label-route-capability\n peer 1.1.1.1 prefix-sid\n peer 4.4.4.4 enable\n peer 4.4.4.4 route-policy policy1 export\n peer 4.4.4.4 reflect-client\n peer 4.4.4.4 next-hop-local\n peer 4.4.4.4 label-route-capability\n peer 4.4.4.4 prefix-sid\n#\nospf 1\n router-id 3.3.3.3\n area 0.0.0.0\n network 3.3.3.3 0.0.0.0\n network 10.1.2.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n if-match mpls-label\n apply mpls-label\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\nmpls lsr-id 4.4.4.4\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\nisis 1\n network-entity 10.0000.0000.0000.0020.00\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.4.1 255.255.255.0\n mpls\n mpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.3.2 255.255.255.0\n isis enable\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 4.4.4.4 255.255.255.255\n isis enable\n#\nbgp 100\n segment-routing global-block 20000\n peer 3.3.3.3 as-number 100\n peer 3.3.3.3 connect-interface LoopBack1\n peer 5.5.5.5 as-number 100\n peer 5.5.5.5 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n peer 3.3.3.3 enable\n peer 3.3.3.3 route-policy policy1 export\n peer 3.3.3.3 reflect-client\n peer 3.3.3.3 next-hop-local\n peer 3.3.3.3 label-route-capability\n peer 3.3.3.3 prefix-sid\n peer 5.5.5.5 enable\n peer 5.5.5.5 route-policy policy1 export\n peer 5.5.5.5 reflect-client\n peer 5.5.5.5 next-hop-local\n peer 5.5.5.5 label-route-capability\n peer 5.5.5.5 prefix-sid\n#\nospf 2\n router-id 4.4.4.4\n area 0.0.0.0\n network 4.4.4.4 0.0.0.0\n network 10.1.4.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n if-match mpls-label\n apply mpls-label\n#\nreturn",
    "DeviceE": "#\nsysname DeviceE\n#\nmpls lsr-id 5.5.5.5\n#\nmpls label advertise non-null\n#\nmpls ldp\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.1.4.2 255.255.255.0\n mpls\n mpls ldp\n#\ninterface LoopBack1\n ip address 5.5.5.5 255.255.255.255\n#\nbgp 100\n segment-routing global-block 22000\n peer 4.4.4.4 as-number 100\n peer 4.4.4.4 connect-interface LoopBack1\n#\nipv4-family unicast\n undo synchronization\n network 5.5.5.5 255.255.255.255 label-index 10\n peer 4.4.4.4 enable\n peer 4.4.4.4 route-policy policy1 export\n peer 4.4.4.4 label-route-capability\n peer 4.4.4.4 prefix-sid\n#\nospf 2\n router-id 5.5.5.5\n area 0.0.0.0\n network 5.5.5.5 0.0.0.0\n network 10.1.4.0 0.0.0.255\n#\nroute-policy policy1 permit node 10\n apply mpls-label\n#\nreturn"
  },
  "related_images": [
    "图1-167 配置BGP SR LSP.png"
  ]
}