{
  "topology": "该网络拓扑由4台路由器组成，分布在2个自治系统中：\n\n**物理拓扑结构：**\n- DeviceA（AS100）通过interface1连接DeviceB的interface1\n- DeviceA（AS100）通过interface2连接DeviceC的interface1\n- DeviceB（AS200）通过interface2连接DeviceD的interface1\n- DeviceC（AS200）通过interface2连接DeviceD的interface2\n- DeviceD（AS200）配置有LoopBack接口interface3\n\n**IP地址分配：**\n- DeviceA-DeviceB链路：10.1.1.0/24网段（DeviceA: 10.1.1.1/24, DeviceB: 10.1.1.2/24）\n- DeviceA-DeviceC链路：10.2.1.0/24网段（DeviceA: 10.2.1.1/24, DeviceC: 10.2.1.2/24）\n- DeviceB-DeviceD链路：10.3.1.0/24网段（DeviceB: 10.3.1.1/24, DeviceD: 10.3.1.2/24）\n- DeviceC-DeviceD链路：10.4.1.0/24网段（DeviceC: 10.4.1.1/24, DeviceD: 10.4.1.2/24）\n- DeviceD的LoopBack1接口：4.4.4.4/32\n- 各设备Router ID分别为：DeviceA（1.1.1.1）、DeviceB（2.2.2.2）、DeviceC（3.3.3.3）、DeviceD（4.4.4.4）\n\n**BGP连接关系：**\n- EBGP连接：DeviceA（AS100）分别与DeviceB（AS200）和DeviceC（AS200）建立连接\n- IBGP连接：AS200内部DeviceD分别与DeviceB和DeviceC建立连接\n\n**BFD配置：**\n- 所有BGP对等体均配置BFD检测功能，参数为：min-tx-interval 100ms、min-rx-interval 100ms、detect-multiplier 4",
  "requirement": "通过配置BGP Auto FRR功能，为DeviceA到DeviceD的路由提供备份转发信息，提高网络可靠性。当主链路出现故障时，系统能够快速将转发路径切换到备份链路上，实现亚秒级业务恢复，满足语音、在线视频和金融等实时性业务的需求。该过程不依赖于路由收敛，大幅缩短业务中断时间。",
  "steps": [
    "DeviceA与DeviceB和DeviceC之间配置EBGP连接。DeviceD与DeviceB和DeviceC之间配置IBGP连接。",
    "在DeviceB、DeviceC上配置路由策略，改变到DeviceD的路由MED值，以便优选路由。",
    "在DeviceA上配置BGP Auto FRR功能。"
  ],
  "configs": {
    "DeviceA": "#\nsysname DeviceA\n#\nbfd\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.1 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.2.1.1 255.255.255.0\n#\nbgp 100\n router-id 1.1.1.1\n peer 10.1.1.2 as-number 200\n peer 10.1.1.2 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.1.1.2 bfd enable\n peer 10.2.1.2 as-number 200\n peer 10.2.1.2 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.2.1.2 bfd enable\n#\n ipv4-family unicast\n  undo synchronization\n  auto-frr\n  peer 10.1.1.2 enable\n  peer 10.2.1.2 enable\n#\nreturn",
    "DeviceB": "#\nsysname DeviceB\n#\nbfd\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.1.1.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.3.1.1 255.255.255.0\n#\nbgp 200\n router-id 2.2.2.2\n peer 10.1.1.1 as-number 100\n peer 10.1.1.1 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.1.1.1 bfd enable\n peer 10.3.1.2 as-number 200\n peer 10.3.1.2 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.3.1.2 bfd enable\n#\n ipv4-family unicast\n  undo synchronization\n  peer 10.1.1.1 route-policy rtb export\n  peer 10.1.1.1 enable\n  peer 10.3.1.2 enable\n#\nroute-policy rtb permit node 10\n apply cost 80\n#\nreturn",
    "DeviceC": "#\nsysname DeviceC\n#\nbfd\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.2.1.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.4.1.1 255.255.255.0\n#\nbgp 200\n router-id 3.3.3.3\n peer 10.2.1.1 as-number 100\n peer 10.2.1.1 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.2.1.1 bfd enable\n peer 10.4.1.2 as-number 200\n peer 10.4.1.2 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.4.1.2 bfd enable\n #\n ipv4-family unicast\n  undo synchronization\n  peer 10.2.1.1 route-policy rtc export\n  peer 10.2.1.1 enable\n  peer 10.4.1.2 enable\n#\nroute-policy rtc permit node 10\n apply cost 120\n#\nreturn",
    "DeviceD": "#\nsysname DeviceD\n#\nbfd\n#\ninterface GigabitEthernet1/0/0\n undo shutdown\n ip address 10.3.1.2 255.255.255.0\n#\ninterface GigabitEthernet2/0/0\n undo shutdown\n ip address 10.4.1.2 255.255.255.0\n#\ninterface LoopBack1\n ip address 4.4.4.4 255.255.255.255\n#\nbgp 200\n router-id 4.4.4.4\n peer 10.3.1.1 as-number 200\n peer 10.3.1.1 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.3.1.1 bfd enable\n peer 10.4.1.1 as-number 200\n peer 10.4.1.1 bfd min-tx-interval 100 min-rx-interval 100 detect-multiplier 4\n peer 10.4.1.1 bfd enable\n #\n ipv4-family unicast\n  undo synchronization\n  network 4.4.4.4 255.255.255.255\n  peer 10.3.1.1 enable\n  peer 10.4.1.1 enable\n#\nreturn"
  },
  
  "related_images": [
    "图1-159 配置BGP Auto FRR 组网图.png"
  ]
}